<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>Chloe 280SE</title>
    <style>
      body {
        background-color: #2a4e96;
      }

      canvas.emscripten {
          border: 0 none;
          background-color: #000;
          display: block;
          margin: 0 auto;
      }

      #controls {
        display: inline-block;
        vertical-align: top;
        margin-top: 30px;
        margin-right: 20px;
    }
  </style>
</head>
<body>
  <span id=controls>
    <span>
      <input type=checkbox id=muted onclick='emulator.toggleMute()'>Mute
      <input type=button id=reset value="Reset" onclick='JSMESS.soft_reset()'>
      <input type=button id=fullscr value="Full Screen" onclick='emulator.requestFullScreen()'>
    </span>
  </span>
  <canvas id=canvas class=emscripten />

    <script type="text/javascript" src="es6-promise.js"></script>
    <script type="text/javascript" src="browserfs.min.js"></script>
    <script type="text/javascript" src="loader.js"></script>
    <script type="text/javascript">
      const queryString = window.location.search;
      const urlParams = new URLSearchParams(queryString);
      var image = urlParams.get('image');
      var waitAfterDownloading = false;
      if (image == undefined) {
        image = "chloe";
        waitAfterDownloading = true;
      }

      var loader = new MAMELoader(MAMELoader.driver("chloe"),
                  MAMELoader.nativeResolution(640, 480),
                  MAMELoader.emulatorJS("mame.js"),
                  MAMELoader.emulatorWASM("mame.wasm"),
                  MAMELoader.mountFile("kb_ms_natural.zip", MAMELoader.fetchFile("Keyboard", "roms/kb_ms_natural.zip")),
                  MAMELoader.mountFile("cfg/chloe.cfg", MAMELoader.fetchFile("Cfg", "cfg/chloe.cfg")),
                  MAMELoader.mountFile("chloe.zip", MAMELoader.fetchFile("Bios", "roms/chloe.zip")),
                  MAMELoader.mountFile(image + ".img", MAMELoader.fetchFile("Disk IMG: " + image, "software/" + image + ".img")),
                  MAMELoader.peripheral("cfg_directory", "cfg"),
                  MAMELoader.peripheral("hard1", image + ".img"),
                  MAMELoader.extraArgs([]));

      var emulator = new Emulator(document.querySelector("#canvas"), null, loader);
      emulator.start({ waitAfterDownloading: waitAfterDownloading });
    </script>
  </body>
</html>
